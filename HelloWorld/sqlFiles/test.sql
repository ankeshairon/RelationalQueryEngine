CREATE TABLE TEST(ID string, NAME string, FIRST int, LAST int)
SELECT FIRST, COUNT(FIRST), COUNT(LAST), SUM(LAST  -1),SUM(FIRST -1), SUM(LAST * (FIRST -1)) FROM TEST GROUP BY FIRST

20|2.0
30|2.0