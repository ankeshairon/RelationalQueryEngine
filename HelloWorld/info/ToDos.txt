- check if aggregation require writing to file
- make multithreaded hash
